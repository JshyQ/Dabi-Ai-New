import axios from "axios";

export default {
  name: "nhentai-download",
  command: ["nhdl"],
  tags: "nsfw",
  desc: "Download doujin from nhentai.net as ZIP",
  prefix: true,
  owner: false,
  premium: false,

  run: async (conn, msg, { chatInfo, args }) => {
    const { chatId } = chatInfo;
    const doujinId = args[0];
    if (!doujinId) {
      return conn.sendMessage(chatId, {
        text: "‚ùå ID doujin tidak valid.",
        quoted: msg
      });
    }

   
    const zipUrl = `https://dl.nhentai.xxx/g/${doujinId}.zip`;

    try {
      await axios.head(zipUrl); // test if exists
      await conn.sendMessage(
        chatId,
        {
          document: { url: zipUrl },
          mimetype: "application/zip",
          fileName: `nhentai_${doujinId}.zip`,
          caption: `üì• Doujin ZIP: https://nhentai.net/g/${doujinId}/`
        },
        { quoted: msg }
      );
    } catch (e) {
      await conn.sendMessage(
        chatId,
        {
          text: `‚ùå Tidak bisa mengunduh ZIP.\nCoba manual: ${zipUrl}\nAtau lihat online: https://nhentai.net/g/${doujinId}/`,
          quoted: msg
        }
      );
    }
  }
};
